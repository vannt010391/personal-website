{% extends 'public/base.html' %}
{% load static %}

{% block title %}{{ post.title }} - Blog{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/blog-zen.css' %}">
<style>
    /* Additional styles for syntax highlighting */
    .codehilite { background: #EFE9E3; border-radius: 12px; padding: 20px; margin: 2em 0; }
    .codehilite pre { background: transparent; padding: 0; margin: 0; }
</style>
{% endblock %}

{% block content %}
<div class="zen-blog">
    <div class="zen-post-detail">
        <!-- Back Button -->
        <a href="{% url 'blog:post_list' %}" class="zen-back-btn">
            Back to list
        </a>

        <!-- Post Header -->
        <header class="zen-post-header zen-fade-in">
            {% if post.category %}
            <div style="margin-bottom: 20px;">
                <a href="{% url 'blog:post_list_by_category' post.category.slug %}" class="zen-post-category">
                    {{ post.category.name }}
                </a>
            </div>
            {% endif %}

            <h1 class="zen-post-detail-title">{{ post.title }}</h1>

            <div class="zen-post-detail-meta">
                <span class="zen-post-meta-item">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 5px;">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    {{ post.author.username }}
                </span>
                <span class="zen-post-meta-item">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 5px;">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    {{ post.published_at|date:"d/m/Y" }}
                </span>
            </div>

            {% if post.status == 'draft' %}
                <div style="background: #F9F8F6; padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid #C9B59C;">
                    <strong>Draft:</strong> This post is not published yet
                </div>
            {% endif %}
        </header>

        <!-- Post Content -->
        <article class="zen-post-content zen-fade-in-delay-1">
            {{ content_html|safe }}
        </article>

        <!-- Post Footer -->
        <footer class="zen-fade-in-delay-2" style="margin-top: 60px; padding-top: 40px; border-top: 1px solid #D9CFC7;">
            <p style="color: #7b7268; font-size: 0.95rem; text-align: center;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 5px;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                Last updated: {{ post.updated_at|date:"d/m/Y H:i" }}
            </p>
        </footer>

        <!-- Admin Actions -->
        {% if user.is_authenticated %}
        <div style="background: linear-gradient(135deg, #C9B59C 0%, #D9CFC7 100%); padding: 30px; border-radius: 16px; margin-top: 60px; text-align: center; box-shadow: 0 8px 30px rgba(201, 181, 156, 0.3);">
            <h3 style="color: white; margin: 0 0 20px; font-weight: 300; font-size: 1.5rem;">Post Management</h3>
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <a href="{% url 'blog:post_update' post.slug %}" 
                   style="padding: 12px 30px; background: white; color: #C9B59C; border-radius: 25px; text-decoration: none; font-weight: 500; transition: all 0.3s; display: inline-block;">
                    Edit
                </a>
                <a href="{% url 'blog:post_delete' post.slug %}" 
                   style="padding: 12px 30px; background: rgba(255,255,255,0.2); color: white; border: 2px solid white; border-radius: 25px; text-decoration: none; font-weight: 500; transition: all 0.3s; display: inline-block;">
                    Delete
                </a>
            </div>
        </div>
        {% endif %}

        <!-- Navigation -->
        <div style="margin-top: 60px; text-align: center;">
            <a href="{% url 'blog:post_list' %}" class="zen-read-more" style="font-size: 1.1rem;">
                View more posts
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.post-content {
    font-size: 1.05em;
}

.post-content h1, .post-content h2, .post-content h3 {
    margin-top: 1.5em;
    margin-bottom: 0.5em;
    color: #3f372f;
}

.post-content h1 {
    font-size: 1.8em;
}

.post-content h2 {
    font-size: 1.5em;
}

.post-content h3 {
    font-size: 1.3em;
}

.post-content p {
    margin-bottom: 1em;
}

.post-content pre {
    background-color: #EFE9E3;
    padding: 15px;
    border-radius: 5px;
    overflow-x: auto;
    border: 1px solid #D9CFC7;
}

.post-content code {
    background-color: #F9F8F6;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
}

.post-content pre code {
    background-color: transparent;
    padding: 0;
}

.post-content blockquote {
    border-left: 4px solid #3498db;
    padding-left: 15px;
    margin: 1em 0;
    color: #555;
    font-style: italic;
}

.post-content ul, .post-content ol {
    margin-left: 30px;
    margin-bottom: 1em;
}

.post-content img {
    max-width: 100%;
    height: auto;
    margin: 20px 0;
    border-radius: 5px;
}

.post-content table {
    border-collapse: collapse;
    width: 100%;
    margin: 20px 0;
}

.post-content table th,
.post-content table td {
    border: 1px solid #D9CFC7;
    padding: 8px;
    text-align: left;
}

.post-content table th {
    background-color: #F9F8F6;
    font-weight: bold;
}
</style>
{% endblock %}
